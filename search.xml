<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Android修改个人头像</title>
      <link href="/2019/01/07/Android%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F/"/>
      <url>/2019/01/07/Android%E4%BF%AE%E6%94%B9%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F/</url>
      
        <content type="html"><![CDATA[<p><strong>写在前面:</strong><br>更换头像这个功能在用户界面几乎是100%出现的。通过拍摄照片或者调用本地图库中的图片，并且进行剪裁，来进行头像的设置。</p><p>一般来说可以通过第三方库来进行裁剪修改，但是其实android 自带的原生的裁剪图片就可以满足日常开发的需求.</p><p>抽时间写了一个基于android原生的裁剪图片的小例子<em>温故而知新吧</em> :joy:</p><hr><h2 id="android-权限的申请"><a href="#android-权限的申请" class="headerlink" title="android 权限的申请"></a>android 权限的申请</h2><blockquote><p>注:Android6.0后相关的敏感权限都需要申请</p></blockquote><p>使用<code>拍摄照片或者</code>调用<code>本地图库</code>需要对以下的权限进行申请</p><ul><li>读写权限（android.permission.WRITE_EXTERNAL_STORAG , android.permission.READ_EXTERNAL_STORAGE）</li><li>相机权限（android.permission.CAMERA）</li></ul><p>相关的期限需要在AndroidManifest.xml文件中进行申请</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;!--照相机权限--&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.CAMERA&quot;&gt;&lt;/uses-permission&gt;</span><br><span class="line">&lt;!--写文件--&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;&gt;&lt;/uses-permission&gt;</span><br><span class="line">&lt;!--读文件--&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_EXTERNAL_STORAGE&quot;&gt;&lt;/uses-permission&gt;</span><br></pre></td></tr></table></figure><p>对权限的申请 可以使用第三方的权限申请库 <a href="https://github.com/getActivity/XXPermissions" target="_blank" rel="noopener">XXPermissions</a> <a href="https://github.com/googlesamples/easypermissions" target="_blank" rel="noopener">EasyPermissions</a> <a href="https://github.com/arvinljw/PermissionHelper" target="_blank" rel="noopener">PermissionHelper</a> …..网上有很多的第三方权限库，自己百度</p><h2 id="裁剪的工具类"><a href="#裁剪的工具类" class="headerlink" title="裁剪的工具类"></a>裁剪的工具类</h2><p>裁剪的工具类，用于用户选择完图片，返回数据进行相关的裁剪</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      *<span class="doctag">@Author</span> 南木</span></span><br><span class="line"><span class="comment">      *<span class="doctag">@Blog</span> https://lucas-liang.github.io/</span></span><br><span class="line"><span class="comment">      *<span class="doctag">@Time</span> 2019/1/7</span></span><br><span class="line"><span class="comment">      *<span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileImageUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Description</span> 调用本地的剪切图片的工具类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Date</span> 2019/1/7</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"NewApi"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getPath</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> Uri uri)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">boolean</span> isKitKat = Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// DocumentProvider</span></span><br><span class="line">        <span class="keyword">if</span> (isKitKat &amp;&amp; DocumentsContract.isDocumentUri(context, uri)) &#123;</span><br><span class="line">            <span class="comment">// ExternalStorageProvider</span></span><br><span class="line">            <span class="keyword">if</span> (isExternalStorageDocument(uri)) &#123;</span><br><span class="line">                <span class="keyword">final</span> String docId = DocumentsContract.getDocumentId(uri);</span><br><span class="line">                <span class="keyword">final</span> String[] split = docId.split(<span class="string">":"</span>);</span><br><span class="line">                <span class="keyword">final</span> String type = split[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="string">"primary"</span>.equalsIgnoreCase(type)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> Environment.getExternalStorageDirectory() + <span class="string">"/"</span> + split[<span class="number">1</span>];</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// DownloadsProvider</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (isDownloadsDocument(uri)) &#123;</span><br><span class="line">                <span class="keyword">final</span> String id = DocumentsContract.getDocumentId(uri);</span><br><span class="line">                <span class="keyword">final</span> Uri contentUri = ContentUris.withAppendedId(</span><br><span class="line">                        Uri.parse(<span class="string">"content://downloads/public_downloads"</span>), Long.valueOf(id));</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> getDataColumn(context, contentUri, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">            &#125; <span class="comment">// MediaProvider</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (isMediaDocument(uri)) &#123;</span><br><span class="line">                <span class="keyword">final</span> String docId = DocumentsContract.getDocumentId(uri);</span><br><span class="line">                <span class="keyword">final</span> String[] split = docId.split(<span class="string">":"</span>);</span><br><span class="line">                <span class="keyword">final</span> String type = split[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                Uri contentUri = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">"image"</span>.equals(type)) &#123;</span><br><span class="line">                    contentUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"video"</span>.equals(type)) &#123;</span><br><span class="line">                    contentUri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"audio"</span>.equals(type)) &#123;</span><br><span class="line">                    contentUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">final</span> String selection = <span class="string">"_id=?"</span>;</span><br><span class="line">                <span class="keyword">final</span> String[] selectionArgs = <span class="keyword">new</span> String[] &#123;</span><br><span class="line">                        split[<span class="number">1</span>]</span><br><span class="line">                &#125;;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> getDataColumn(context, contentUri, selection, selectionArgs);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// MediaStore (and general)</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"content"</span>.equalsIgnoreCase(uri.getScheme())) &#123;</span><br><span class="line">            <span class="comment">// Return the remote address</span></span><br><span class="line">            <span class="keyword">if</span> (isGooglePhotosUri(uri))</span><br><span class="line">                <span class="keyword">return</span> uri.getLastPathSegment();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> getDataColumn(context, uri, <span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// File</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"file"</span>.equalsIgnoreCase(uri.getScheme())) &#123;</span><br><span class="line">            <span class="keyword">return</span> uri.getPath();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the value of the data column for this Uri. This is useful for</span></span><br><span class="line"><span class="comment">     * MediaStore Uris, and other file-based ContentProviders.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context The context.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri The Uri to query.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> selection (Optional) Filter used in the query.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> selectionArgs (Optional) Selection arguments used in the query.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The value of the _data column, which is typically a file path.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getDataColumn</span><span class="params">(Context context, Uri uri, String selection,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       String[] selectionArgs)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Cursor cursor = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">final</span> String column = <span class="string">"_data"</span>;</span><br><span class="line">        <span class="keyword">final</span> String[] projection = &#123;</span><br><span class="line">                column</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cursor = context.getContentResolver().query(uri, projection, selection, selectionArgs,</span><br><span class="line">                    <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">if</span> (cursor != <span class="keyword">null</span> &amp;&amp; cursor.moveToFirst()) &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="keyword">int</span> index = cursor.getColumnIndexOrThrow(column);</span><br><span class="line">                <span class="keyword">return</span> cursor.getString(index);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (cursor != <span class="keyword">null</span>)</span><br><span class="line">                cursor.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri The Uri to check.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Whether the Uri authority is ExternalStorageProvider.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isExternalStorageDocument</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"com.android.externalstorage.documents"</span>.equals(uri.getAuthority());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri The Uri to check.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Whether the Uri authority is DownloadsProvider.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isDownloadsDocument</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"com.android.providers.downloads.documents"</span>.equals(uri.getAuthority());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri The Uri to check.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Whether the Uri authority is MediaProvider.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isMediaDocument</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"com.android.providers.media.documents"</span>.equals(uri.getAuthority());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri The Uri to check.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Whether the Uri authority is Google Photos.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isGooglePhotosUri</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"com.google.android.apps.photos.content"</span>.equals(uri.getAuthority());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Activity中的代码"><a href="#Activity中的代码" class="headerlink" title="Activity中的代码"></a>Activity中的代码</h2><p>在写运行代码时发现在三星上面会报如下错误（好像还是Android7.0的错误）</p><h3 id="Android7-0中报的错误"><a href="#Android7-0中报的错误" class="headerlink" title="Android7.0中报的错误"></a>Android7.0中报的错误</h3><blockquote><p>exposed beyond app through ClipData.Item.getUri()</p></blockquote><p>解决办法：<br>在onCreate中添加如下代码</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">StrictMode.VmPolicy.Builder builder = <span class="keyword">new</span> StrictMode.VmPolicy.Builder();</span><br><span class="line">StrictMode.setVmPolicy(builder.build());</span><br><span class="line">builder.detectFileUriExposure();</span><br></pre></td></tr></table></figure><p><strong>参考链接 <a href="https://blog.csdn.net/guiping_ding/article/details/78502290" target="_blank" rel="noopener">解决exposed beyond app through ClipData.Item.getUri() 错误</a></strong></p><p>具体实现代码</p><blockquote><p>注： 下面的代码出现的ImageView、Button  均可自己定义<br>主要的还是要看dialog中实现的东西</p></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">private</span> ImageView avatar;</span><br><span class="line">    <span class="keyword">private</span> Button update;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CHOOSE_PICTURE = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TAKE_PICTURE = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> CROP_SMALL_PICTURE = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">/* 头像文件 */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String IMAGE_FILE_NAME = <span class="string">"acatar_image.jpg"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> Uri tempUri;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"NewApi"</span>)</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="comment">//TODO android 7.0 解决 exposed beyond app through ClipData.Item.getUri()</span></span><br><span class="line">        StrictMode.VmPolicy.Builder builder = <span class="keyword">new</span> StrictMode.VmPolicy.Builder();</span><br><span class="line">        StrictMode.setVmPolicy(builder.build());</span><br><span class="line">        builder.detectFileUriExposure();</span><br><span class="line"></span><br><span class="line">        initView();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">getPermission</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!XXPermissions.isHasPermission(<span class="keyword">this</span>, Permission.Group.STORAGE)</span><br><span class="line">                ||!XXPermissions.isHasPermission(<span class="keyword">this</span>,Permission.CAMERA)) &#123;</span><br><span class="line">            XXPermissions.with(<span class="keyword">this</span>)</span><br><span class="line">                    <span class="comment">//.constantRequest() //可设置被拒绝后继续申请，直到用户授权或者永久拒绝</span></span><br><span class="line">                    <span class="comment">//.permission(Permission.SYSTEM_ALERT_WINDOW, Permission.REQUEST_INSTALL_PACKAGES) //支持请求6.0悬浮窗权限8.0请求安装权限</span></span><br><span class="line">                    .permission(Permission.WRITE_EXTERNAL_STORAGE,Permission.CAMERA,Permission.READ_EXTERNAL_STORAGE ) <span class="comment">//不指定权限则自动获取清单中的危险权限</span></span><br><span class="line">                    .request(<span class="keyword">new</span> OnPermission() &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hasPermission</span><span class="params">(List&lt;String&gt; granted, <span class="keyword">boolean</span> isAll)</span> </span>&#123;</span><br><span class="line">                            Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"权限申请成功！"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">noPermission</span><span class="params">(List&lt;String&gt; denied, <span class="keyword">boolean</span> quick)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//    通过AlertDialog.Builder这个类来实例化我们的一个AlertDialog的对象</span></span><br><span class="line">            AlertDialog.Builder builder = <span class="keyword">new</span> AlertDialog.Builder(MainActivity.<span class="keyword">this</span>);</span><br><span class="line">            <span class="comment">//    设置Title的内容</span></span><br><span class="line">            builder.setTitle(<span class="string">"设置头像"</span>);</span><br><span class="line">            <span class="comment">//    设置Content来显示一个信息</span></span><br><span class="line">            builder.setMessage(<span class="string">"设置自己的头像"</span>);</span><br><span class="line">            <span class="comment">//    设置一个PositiveButton</span></span><br><span class="line">            builder.setPositiveButton(<span class="string">"本地图片"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">                    Intent intent = <span class="keyword">new</span> Intent(</span><br><span class="line">                            Intent.ACTION_GET_CONTENT);</span><br><span class="line">                    <span class="keyword">if</span> (Build.VERSION.SDK_INT &lt; <span class="number">19</span>) &#123;</span><br><span class="line">                        intent.setType(<span class="string">"image/*"</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        intent = <span class="keyword">new</span> Intent(Intent.ACTION_PICK, android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);</span><br><span class="line">                    &#125;</span><br><span class="line">                    startActivityForResult(intent, CHOOSE_PICTURE);</span><br><span class="line">                    dialog.dismiss();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//    设置一个NegativeButton</span></span><br><span class="line">            builder.setNegativeButton(<span class="string">"拍照"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">                    Intent intent = <span class="keyword">new</span> Intent(MediaStore.ACTION_IMAGE_CAPTURE);</span><br><span class="line">                    <span class="keyword">if</span> (hasSdcard()) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (hasSdcard()) &#123;</span><br><span class="line">                            intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(<span class="keyword">new</span> File(Environment</span><br><span class="line">                                    .getExternalStorageDirectory(), IMAGE_FILE_NAME)));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    startActivityForResult(intent, TAKE_PICTURE);</span><br><span class="line">                    dialog.dismiss();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//    设置一个NeutralButton</span></span><br><span class="line">            builder.setNeutralButton(<span class="string">"取消"</span>, <span class="keyword">new</span> DialogInterface.OnClickListener() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(DialogInterface dialog, <span class="keyword">int</span> which)</span> </span>&#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"neutral: "</span> + which, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">//    显示出该对话框</span></span><br><span class="line">            builder.show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, @Nullable Intent data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onActivityResult(requestCode, resultCode, data);</span><br><span class="line">        <span class="keyword">if</span> (resultCode == RESULT_OK) &#123; <span class="comment">// 如果返回码是可以用的</span></span><br><span class="line">            <span class="keyword">switch</span> (requestCode) &#123;</span><br><span class="line">                <span class="keyword">case</span> TAKE_PICTURE:</span><br><span class="line">                    <span class="keyword">if</span> (hasSdcard()) &#123;</span><br><span class="line">                        File tempFile = <span class="keyword">new</span> File(</span><br><span class="line">                                Environment.getExternalStorageDirectory(),</span><br><span class="line">                                IMAGE_FILE_NAME);</span><br><span class="line">                        startPhotoZoom(Uri.fromFile(tempFile));</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        Toast.makeText(getApplication(), <span class="string">"没有SDCard!"</span>, Toast.LENGTH_LONG)</span><br><span class="line">                                .show();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">// 开始对图片进行裁剪处理</span></span><br><span class="line">                <span class="keyword">case</span> CHOOSE_PICTURE:</span><br><span class="line">                    startPhotoZoom(data.getData());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="comment">//提交网络图片</span></span><br><span class="line">                <span class="keyword">case</span> CROP_SMALL_PICTURE:</span><br><span class="line">                    <span class="keyword">if</span> (data != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="comment">/*setImageToView(data); // 让刚才选择裁剪得到的图片显示在界面上*/</span></span><br><span class="line">                        sendImageByNet(data);</span><br><span class="line">                        <span class="comment">//savePhoto(data);</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取本地加载的</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendImageByNet</span><span class="params">(Intent data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (data != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Bitmap bitmap = data.getParcelableExtra(<span class="string">"data"</span>);</span><br><span class="line">            avatar.setImageBitmap(bitmap);</span><br><span class="line">            <span class="comment">//提交图片到服务器  base64  或者  bitmap 提交文件</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 裁剪图片方法实现</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> uri</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*裁剪图片*/</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">startPhotoZoom</span><span class="params">(Uri uri)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (uri == <span class="keyword">null</span>) &#123;</span><br><span class="line">            Log.i(<span class="string">"tag"</span>, <span class="string">"The uri is not exist."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        tempUri = uri;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.android.camera.action.CROP"</span>);</span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123;</span><br><span class="line">            File uriFile = <span class="keyword">new</span> File(FileImageUtil.getPath(<span class="keyword">this</span>, tempUri));</span><br><span class="line">            intent.setDataAndType(Uri.fromFile(uriFile), <span class="string">"image/*"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            intent.setDataAndType(tempUri, <span class="string">"image/*"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// crop为true是设置在开启的intent中设置显示的view可以剪裁</span></span><br><span class="line">        intent.putExtra(<span class="string">"crop"</span>, <span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//        intent.putExtra("scale", true);</span></span><br><span class="line">        <span class="comment">// aspectX aspectY 是宽高的比例</span></span><br><span class="line">        intent.putExtra(<span class="string">"aspectX"</span>, <span class="number">1</span>);</span><br><span class="line">        intent.putExtra(<span class="string">"aspectY"</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// outputX,outputY 是剪裁图片的宽高</span></span><br><span class="line">        intent.putExtra(<span class="string">"outputX"</span>, <span class="number">200</span>);</span><br><span class="line">        intent.putExtra(<span class="string">"outputY"</span>, <span class="number">150</span>);</span><br><span class="line">        intent.putExtra(<span class="string">"return-data"</span>, <span class="keyword">true</span>);</span><br><span class="line">        startActivityForResult(intent, CROP_SMALL_PICTURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 检查设备是否存在SDCard的工具方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasSdcard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String state = Environment.getExternalStorageState();</span><br><span class="line">        <span class="keyword">if</span> (state.equals(Environment.MEDIA_MOUNTED)) &#123;</span><br><span class="line">            <span class="comment">// 有存储的SDCard</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//findViewById </span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        avatar = (ImageView) findViewById(R.id.avatar);</span><br><span class="line">        update = (Button) findViewById(R.id.update);</span><br><span class="line">        update.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (v.getId()) &#123;</span><br><span class="line">            <span class="keyword">case</span> R.id.update:</span><br><span class="line">                getPermission();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>时间工具类</title>
      <link href="/2019/01/04/%E6%97%B6%E9%97%B4%E5%B7%A5%E5%85%B7%E7%B1%BB/"/>
      <url>/2019/01/04/%E6%97%B6%E9%97%B4%E5%B7%A5%E5%85%B7%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<p>这段时间在公司中做公司的项目，期间用了时间相关处理类，但是一直都是东写一点西写一点，算了找个时间来写一个关于时间的工具类，以便于以后直接调用（写的不好勿喷，谢谢）。</p><p>附上我的工具类的地址–&gt;<a href="https://github.com/Lucas-Liang/ToolPackage/blob/master/src/Time/TimeUtils.java" target="_blank" rel="noopener">TiemUtils</a> (随缘更新)</p><p>java.util 包提供了 Date 类来封装当前的日期和时间。 Date 类提供两个构造函数来实例化 Date 对象。</p><h2 id="不同类型的时间-相互转化"><a href="#不同类型的时间-相互转化" class="headerlink" title="不同类型的时间 相互转化"></a>不同类型的时间 相互转化</h2><p>主要是<code>Data</code>、<code>long</code> 、<code>String</code> 之间的转化</p><h3 id="转换为String类型"><a href="#转换为String类型" class="headerlink" title="转换为String类型"></a>转换为String类型</h3><h4 id="date类型转换为String类型"><a href="#date类型转换为String类型" class="headerlink" title="date类型转换为String类型"></a><code>date</code>类型转换为<code>String</code>类型</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">longToString</span><span class="params">(<span class="keyword">long</span> currentTime, String formatType)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">    Date date = longToDate(currentTime, formatType);</span><br><span class="line">    String strTime = dateToString(date, formatType);</span><br><span class="line">    <span class="keyword">return</span> strTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="long类型转换为String类型"><a href="#long类型转换为String类型" class="headerlink" title="long类型转换为String类型"></a><code>long</code>类型转换为<code>String</code>类型</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">longToString</span><span class="params">(<span class="keyword">long</span> currentTime, String formatType)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">    Date date = longToDate(currentTime, formatType);</span><br><span class="line">    String strTime = dateToString(date, formatType);</span><br><span class="line">    <span class="keyword">return</span> strTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="转换为date类型"><a href="#转换为date类型" class="headerlink" title="转换为date类型"></a>转换为<code>date</code>类型</h3><h4 id="string类型转换为date类型"><a href="#string类型转换为date类型" class="headerlink" title="string类型转换为date类型"></a><code>string</code>类型转换为<code>date</code>类型</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">stringToDate</span><span class="params">(String strTime, String formatType)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">    SimpleDateFormat formatter = <span class="keyword">new</span> SimpleDateFormat(formatType);</span><br><span class="line">    Date date = <span class="keyword">null</span>;</span><br><span class="line">    date = formatter.parse(strTime);</span><br><span class="line">    <span class="keyword">return</span> date;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="long转换为Date类型"><a href="#long转换为Date类型" class="headerlink" title="long转换为Date类型"></a><code>long</code>转换为<code>Date</code>类型</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Date <span class="title">longToDate</span><span class="params">(<span class="keyword">long</span> currentTime, String formatType)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">    Date dateOld = <span class="keyword">new</span> Date(currentTime);</span><br><span class="line">    String sDateTime = dateToString(dateOld, formatType);</span><br><span class="line">    Date date = stringToDate(sDateTime, formatType);</span><br><span class="line">    <span class="keyword">return</span> date;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="转换为long类型"><a href="#转换为long类型" class="headerlink" title="转换为long类型"></a>转换为<code>long</code>类型</h3><h4 id="string类型转换为long类型"><a href="#string类型转换为long类型" class="headerlink" title="string类型转换为long类型"></a><code>string</code>类型转换为<code>long</code>类型</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">stringToLong</span><span class="params">(String strTime, String formatType)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> ParseException </span>&#123;</span><br><span class="line">    Date date = stringToDate(strTime, formatType);</span><br><span class="line">    <span class="keyword">if</span> (date == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">long</span> currentTime = dateToLong(date);</span><br><span class="line">        <span class="keyword">return</span> currentTime;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="date类型转换为long类型"><a href="#date类型转换为long类型" class="headerlink" title="date类型转换为long类型"></a><code>date</code>类型转换为<code>long</code>类型</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">dateToLong</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> date.getTime();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来就是一些常见对于时间的操作</p><h2 id="返回String类型的时间字符串"><a href="#返回String类型的时间字符串" class="headerlink" title="返回String类型的时间字符串"></a>返回<code>String</code>类型的时间字符串</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getCurrentTimeStr</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getCurrentTimeStr(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getCurrentTimeYear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getCurrentTimeStr(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getCurrentTimeStrHour</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getCurrentTimeStr(<span class="string">"HH:mm:ss"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getCurrentTimeStr</span><span class="params">(String custom)</span> </span>&#123;</span><br><span class="line">    Calendar curCalendar = Calendar.getInstance();</span><br><span class="line">    DateFormat df = <span class="keyword">new</span> SimpleDateFormat(custom);</span><br><span class="line">    <span class="keyword">return</span> df.format(curCalendar.getTime());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="将时间戳转成格式化时间返回String"><a href="#将时间戳转成格式化时间返回String" class="headerlink" title="将时间戳转成格式化时间返回String"></a>将时间戳转成格式化时间返回<code>String</code></h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFormatTime</span><span class="params">(<span class="keyword">long</span> milliseconds)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getFormatTime(milliseconds,<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFormatTimeYear</span><span class="params">(<span class="keyword">long</span> milliseconds)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getFormatTime(milliseconds,<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFormatTimeHour</span><span class="params">(<span class="keyword">long</span> milliseconds)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> getFormatTime(milliseconds,<span class="string">"HH:mm:ss"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFormatTime</span><span class="params">(<span class="keyword">long</span> milliseconds,String custom)</span> </span>&#123;</span><br><span class="line">    SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(custom);</span><br><span class="line">    <span class="keyword">return</span> sdf.format(<span class="keyword">new</span> Date(milliseconds));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="返回文字描述的日期"><a href="#返回文字描述的日期" class="headerlink" title="返回文字描述的日期"></a>返回文字描述的日期</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getTimeFormatText</span><span class="params">(<span class="keyword">long</span> date)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (date == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    date = date * <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">long</span> diff = <span class="keyword">new</span> Date().getTime() - date;</span><br><span class="line">    <span class="keyword">long</span> r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (diff &gt; year) &#123; r = (diff / year); <span class="keyword">return</span> r + <span class="string">"年前"</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (diff &gt; month) &#123; r = (diff / month);<span class="keyword">return</span> r + <span class="string">"月前"</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (diff &gt; day) &#123; r = (diff / day);<span class="keyword">return</span> r + <span class="string">"天前"</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (diff &gt; hour) &#123; r = (diff / hour);<span class="keyword">return</span> r + <span class="string">"小时前"</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (diff &gt; minute) &#123; r = (diff / minute);<span class="keyword">return</span> r + <span class="string">"分钟前"</span>; &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"刚刚"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="计算两个日期之间相差的天数"><a href="#计算两个日期之间相差的天数" class="headerlink" title="计算两个日期之间相差的天数"></a>计算两个日期之间相差的天数</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">daysBetween</span><span class="params">(Date date1, Date date2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">boolean</span> result = date1.before(date2);<span class="comment">//对比时间的前后</span></span><br><span class="line">    Date sdate,bdate;</span><br><span class="line">    <span class="keyword">if</span>(result==<span class="keyword">true</span>)&#123;</span><br><span class="line">        sdate = date2;bdate = date1;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        sdate = date1;bdate = date2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> days = (<span class="keyword">int</span>) ((sdate.getTime() - bdate.getTime()) / (<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>));</span><br><span class="line">    <span class="keyword">return</span> days;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="获取分秒格式化字符串"><a href="#获取分秒格式化字符串" class="headerlink" title="获取分秒格式化字符串"></a>获取分秒格式化字符串</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFormatMiniteSecString</span><span class="params">(<span class="keyword">int</span> time)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> second = time % <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">int</span> minute = time / <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">int</span> hour = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (minute &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">        hour = minute / <span class="number">60</span>;</span><br><span class="line">        minute = minute % <span class="number">60</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    String timeString = <span class="string">""</span>;</span><br><span class="line">    String secondString = <span class="string">""</span>;</span><br><span class="line">    String minuteString = <span class="string">""</span>;</span><br><span class="line">    String hourString = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span> (second &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        secondString = <span class="string">"0"</span> + second;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        secondString = second + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (minute &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        minuteString = <span class="string">"0"</span> + minute;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        minuteString = minute + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hour &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        hourString = <span class="string">"0"</span> + hour;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        hourString = hour + <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hour != <span class="number">0</span>) &#123;</span><br><span class="line">        timeString = hourString + <span class="string">":"</span> + minuteString + <span class="string">":"</span> + secondString;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        timeString = minuteString + <span class="string">":"</span> + secondString;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> timeString;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>##判断选择的日期</p><h3 id="判断选择的日期是否是本月"><a href="#判断选择的日期是否是本月" class="headerlink" title="判断选择的日期是否是本月"></a>判断选择的日期是否是本月</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isThisMonth</span><span class="params">(<span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isThisTime(time,<span class="string">"yyyy-MM"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="判断选择的日期是否是本周"><a href="#判断选择的日期是否是本周" class="headerlink" title="判断选择的日期是否是本周"></a>判断选择的日期是否是本周</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isThisWeek</span><span class="params">(<span class="keyword">long</span> time)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Calendar calendar = Calendar.getInstance();</span><br><span class="line">    <span class="keyword">int</span> currentWeek = calendar.get(Calendar.WEEK_OF_YEAR);</span><br><span class="line">    calendar.setTime(<span class="keyword">new</span> Date(time));</span><br><span class="line">    <span class="keyword">int</span> paramWeek = calendar.get(Calendar.WEEK_OF_YEAR);</span><br><span class="line">    <span class="keyword">if</span>(paramWeek==currentWeek) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="判断选择的日期是否是今天"><a href="#判断选择的日期是否是今天" class="headerlink" title="判断选择的日期是否是今天"></a>判断选择的日期是否是今天</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isToday</span><span class="params">(<span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isThisTime(time,<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="处理时间对比的类"><a href="#处理时间对比的类" class="headerlink" title="处理时间对比的类"></a>处理时间对比的类</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isThisTime</span><span class="params">(<span class="keyword">long</span> time,String pattern)</span> </span>&#123;</span><br><span class="line">    Date date = <span class="keyword">new</span> Date(time);</span><br><span class="line">    SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(pattern);</span><br><span class="line">    String param = sdf.format(date);<span class="comment">//参数时间</span></span><br><span class="line">    String now = sdf.format(<span class="keyword">new</span> Date());<span class="comment">//当前时间</span></span><br><span class="line">    <span class="keyword">if</span>(param.equals(now)) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="判断当前时间是否在-startTime-endTime-区间，注意时间格式要一致"><a href="#判断当前时间是否在-startTime-endTime-区间，注意时间格式要一致" class="headerlink" title="判断当前时间是否在[startTime, endTime]区间，注意时间格式要一致"></a>判断当前时间是否在[startTime, endTime]区间，注意时间格式要一致</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isEffectiveDate</span><span class="params">(Date nowTime, Date startTime, Date endTime)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (nowTime.getTime() == startTime.getTime() || nowTime.getTime() == endTime.getTime())</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (nowTime.after(startTime) &amp;&amp; nowTime.before(endTime)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后可能想到什么更新什么、看具体遇见的需求，有更新的我会在更新的</p><blockquote><p>最后更新时间2018-12-31 12:00:00</p></blockquote><blockquote><p>我在网上写的文章、项目都可以转载，但请注明出处，这是我唯一的要求。当然纯我个人原创的成果被转载了，不注明出处也是没有关系的，但是由我转载或者借鉴了别人的成果的请注明他人的出处，算是对前辈们的一种尊重吧！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 工具类 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> 工具类 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>你好世界</title>
      <link href="/2018/12/31/%E4%BD%A0%E5%A5%BD%EF%BC%8C%E4%B8%96%E7%95%8C/"/>
      <url>/2018/12/31/%E4%BD%A0%E5%A5%BD%EF%BC%8C%E4%B8%96%E7%95%8C/</url>
      
        <content type="html"><![CDATA[<h2 id="你好世界"><a href="#你好世界" class="headerlink" title="你好世界"></a>你好世界</h2><p>Hello world！这是我在Wordpress上第二次发布这个信息了。</p><p>第一次是在本地机器上，这次是真正在网站上发布了。</p><meta http-equiv="refresh" content="0.1">]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
